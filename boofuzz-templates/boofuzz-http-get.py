import sys
from boofuzz import *

def main():
	host = '127.0.0.1'
	port = '80'

	f = open('boofuzz-http-get.log', 'wb')
	logger = FuzzLogger(fuzz_loggers=[FuzzLoggerText(file_handle=f)])


	session = Session(
		target=Target(
			connection=SocketConnection(host, int(port), proto='tcp', timeout=2.0),
		),
		fuzz_data_logger=logger
	)

	s_initialize(name="Post")
	with s_block("Post-Header"):
        	s_static('GET', name='Request-Method'), s_delim(' ', name='Request-Space-1'), s_string('/', name='Request-URI'), s_delim(' ', name='Request-Space-2'), s_string('HTTP/1.1', name='Request-HTTP-Ver'), s_static('\r\n', name='Request-CRLF'),
		s_static('Host', name='Host-Header'), s_delim(':', name='Host-Colon-1'), s_delim(' ', name='Host-Space-1'), s_string('192.168.0.96', name='Host-Host'), s_static('\r\n', name='Host-CRLF'),
		s_static('Connection', name='Connection-Header'), s_delim(':', name='Connection-Colon-1'), s_delim(' ', name='Connection-Space-1'), s_group('Connection-Type', ['keep-alive', 'close']), s_static('\r\n', 'Connection-CRLF'),
		s_static('Cache-Control', name='Cache-Control-Header'), s_delim(':', name='Cache-Control-Colon-1'), s_delim(' ', name='Cache-Control-Space-1'), s_group('Cache-Control-Value', ['max-age', 'max-stale', 'min-fresh', 'no-cache', 'no-store', 'no-transform', 'only-if-cached']), s_delim('=', name='Cache-Control-Value-Equal-1'), s_string('0', name='Cache-Control-Value-number'), s_static('\r\n', name='Cache-Control-CRLF'),
		s_static('Upgrade-Insecure-Requests', name='Upgrade-Insecure-Request-Header'), s_delim(':', name='Upgrade-Insecure-Requests-Colon-1'), s_delim(' ', name='Upgrade-Insecure-Request-Space-1'), s_string('1', name='Upgrade-Insecure-Request-Value'), s_static('\r\n', name='Upgrade-Insecure-Reuquests-CRLF'),
		s_static('User-Agent', name='User-Agent-Header'), s_delim(':', name='User-Agent-Colon-1'), s_delim(' ', name='User-Agent-Space-1'), s_string('Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3223.8 Safari/537.36', name='User-Agent-Value'), s_static('\r\n', name='User-Agent-CRLF'),
		s_static('Accept', name='Accept-Header'), s_delim(':', name='Accept-Colon-1'), s_delim(' ', name='Accept-Space-1'), s_string('text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', name='Accept-Value'), s_static('\r\n', name='Accept-CRLF'),
		s_static('Referer', name='Referer-Header'), s_delim(':', name='Referer-Colon-1'), s_delim(' ', name='Referer-Space-1'), s_string('http://' + host + '/', name='Referer-Value'), s_static('\r\n', name='Referer-CRLF'),
		s_static('Accept-Encoding', name='Accept-Encoding-Header'), s_delim(':', name='Accept-Encoding-Colon-1'), s_delim(' ', name='Accept-Encoding-Space-1'), s_string('gzip, deflate', name='Accpet-Encoding-Value'), s_static('\r\n', name='Accept-Encoding-CRLF'),
		s_static('Accept-Language', name='Accept-Language-Header'), s_delim(':', name='Accept-Language-Colon-1'), s_delim(' ', name='Accept-Language-Space-1'), s_string('en-US,en;q=0.9', name='Accept-Language-Value'), s_static('\r\n\r\n', name='Accept-Language-CRLF')

	session.connect(s_get("Post"))

	session.fuzz()

if __name__ == '__main__':
	main()
